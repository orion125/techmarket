SQL> @.\03_create_TechMarket.sql
SQL> -- --------------------------------------------------------------------------------------------------------------------------------------------------
SQL> -- Script : 03_create_TechMarket.sql
SQL> -- Objet  : Création des tables et BDD TechMarket sur SGBD Oracle en Local (HEGLOCAL)
SQL> --
SQL> -- Auteur : CAPITAO Jonathan
SQL> -- Mise à jour des versions
SQL> -- Version  Visa	Date	   Commentaires
SQL> -- -----  ------  --------    ------------------------------------------------------------------------------------------------------------------------
SQL> -- 1.0	  GA   21.11.15    Création des Tables
SQL> -- ---------------------------------------------------------------------------------------------------------------------------------------------------
SQL> --<ScriptOptions statementTerminator=;/>
SQL> 
SQL> 
SQL> -- Néttoyage -----------------------------------------------------------------------------------------------------------------------------------------
SQL> 
SQL> -- Suppression tables
SQL> DROP TABLE tm_changestockenatt CASCADE CONSTRAINTS ;

Table supprimée.

SQL> DROP TABLE tm_client CASCADE CONSTRAINTS ;

Table supprimée.

SQL> DROP TABLE tm_commande CASCADE CONSTRAINTS ;

Table supprimée.

SQL> DROP TABLE tm_compoasspecvalue CASCADE CONSTRAINTS ;

Table supprimée.

SQL> DROP TABLE tm_composant CASCADE CONSTRAINTS ;

Table supprimée.

SQL> DROP TABLE tm_compoasstock CASCADE CONSTRAINTS ;

Table supprimée.

SQL> DROP TABLE tm_composanttype CASCADE CONSTRAINTS ;

Table supprimée.

SQL> DROP TABLE tm_compotypeasmarque CASCADE CONSTRAINTS ;

Table supprimée.

SQL> DROP TABLE tm_compotypeasspec CASCADE CONSTRAINTS ;

Table supprimée.

SQL> DROP TABLE tm_emplacement CASCADE CONSTRAINTS ;

Table supprimée.

SQL> DROP TABLE tm_lignecommande CASCADE CONSTRAINTS ;

Table supprimée.

SQL> DROP TABLE tm_manager CASCADE CONSTRAINTS ;

Table supprimée.

SQL> DROP TABLE tm_marque CASCADE CONSTRAINTS ;

Table supprimée.

SQL> DROP TABLE tm_specification CASCADE CONSTRAINTS ;

Table supprimée.

SQL> DROP TABLE tm_specasvalue CASCADE CONSTRAINTS ;

Table supprimée.

SQL> 
SQL> -- Création des Tables  ------------------------------------------------------------------------------------------------------------------------------
SQL> 
SQL> CREATE TABLE tm_changestockenatt (
  2  		     cha_comment VARCHAR2(500),
  3  		     cha_etat NUMBER(1 , 0) NOT NULL,
  4  		     cha_qte NUMBER(3 , 0) NOT NULL,
  5  		     cha_id NUMBER(9 , 0) NOT NULL,
  6  		     cha_datechange DATE DEFAULT SYSDATE,
  7  		     cha_cos_cmp_id NUMBER(6 , 0) NOT NULL,
  8  		     cha_cos_emp_id NUMBER(3 , 0)
  9  	     );

Table créée.

SQL> 
SQL> CREATE TABLE tm_client (
  2  		     cli_nom VARCHAR2(125),
  3  		     cli_prenom VARCHAR2(50),
  4  		     cli_telephone VARCHAR2(50),
  5  		     cli_address VARCHAR2(200),
  6  		     cli_mail VARCHAR2(125),
  7  		     cli_id NUMBER(5 , 0) NOT NULL
  8  	     );

Table créée.

SQL> 
SQL> CREATE TABLE tm_commande (
  2  		     com_id NUMBER(8 , 0) NOT NULL,
  3  		     com_cli_id NUMBER(5 , 0) NOT NULL
  4  	     );

Table créée.

SQL> 
SQL> 
SQL> CREATE TABLE tm_compoasspecvalue (
  2  		     cov_spv_id NUMBER(7 , 0) NOT NULL,
  3  		     cov_cmp_id NUMBER(6 , 0) NOT NULL
  4  	     );

Table créée.

SQL> 
SQL> CREATE TABLE tm_compoasstock (
  2  		     cos_nbstockvirtuel NUMBER(4 , 0) DEFAULT 0 NOT NULL,
  3  		     cos_nbstockphysique NUMBER(4 , 0) DEFAULT 0 NOT NULL,
  4  		     cos_emp_id NUMBER(3 , 0) NOT NULL,
  5  		     cos_cmp_id NUMERIC(6 , 0) NOT NULL
  6  	     );

Table créée.

SQL> 
SQL> CREATE TABLE tm_composant (
  2  		     cmp_id NUMBER(6 , 0) NOT NULL,
  3  		     cmp_nom VARCHAR2(200),
  4  		     cmp_prix NUMBER(7 , 2),
  5  		     cmp_mar_id NUMBER(3 , 0) NOT NULL,
  6  		     cmp_cot_id NUMBER(2 , 0) NOT NULL
  7  	     );

Table créée.

SQL> 
SQL> CREATE TABLE tm_composanttype (
  2  		     cot_id NUMBER(2 , 0) NOT NULL,
  3  		     cot_nom VARCHAR2(125)
  4  	     );

Table créée.

SQL> 
SQL> CREATE TABLE tm_compotypeasmarque (
  2  		     ctm_mar_id NUMBER(3 , 0) NOT NULL,
  3  		     ctm_cot_id NUMBER(2 , 0) NOT NULL
  4  	     );

Table créée.

SQL> 
SQL> CREATE TABLE tm_compotypeasspec (
  2  		     cts_cot_id NUMBER(2 , 0) NOT NULL,
  3  		     cts_spc_id NUMBER(6 , 0) NOT NULL
  4  	     );

Table créée.

SQL> 
SQL> CREATE TABLE tm_emplacement (
  2  		     emp_id NUMBER(3 , 0) NOT NULL,
  3  		     emp_nom VARCHAR2(200)
  4  	     );

Table créée.

SQL> 
SQL> CREATE TABLE tm_lignecommande (
  2  		     lco_cmp_id NUMBER(6 , 0) NOT NULL,
  3  		     lco_com_id NUMBER(8 , 0) NOT NULL,
  4  		     lco_qte NUMBER(3 , 0) DEFAULT 1 NOT NULL
  5  	     );

Table créée.

SQL> 
SQL> CREATE TABLE tm_manager (
  2  		     man_id NUMBER(2 , 0) NOT NULL,
  3  		     man_username VARCHAR2(50),
  4  		     man_password VARCHAR2(50)
  5  	     );

Table créée.

SQL> 
SQL> CREATE TABLE tm_marque (
  2  		     mar_id NUMBER(3 , 0) NOT NULL,
  3  		     mar_nom VARCHAR2(125)
  4  	     );

Table créée.

SQL> 
SQL> CREATE TABLE tm_specasvalue (
  2  		     spv_id NUMBER(7 , 0) NOT NULL,
  3  		     spv_spc_id NUMBER(6 , 0) NOT NULL,
  4  		     spv_value VARCHAR2(50)
  5  	     );

Table créée.

SQL> 
SQL> CREATE TABLE tm_specification (
  2  		     spc_nom VARCHAR2(125),
  3  		     spc_id NUMBER(6 , 0) NOT NULL
  4  	     );

Table créée.

SQL> 
SQL> -- Création des Contraintes  ------------------------------------------------------------------------------------------------------------------------------
SQL> ALTER TABLE tm_changestockenatt ADD CONSTRAINT tm_changestockenatt_pk PRIMARY KEY(cha_id);

Table modifiée.

SQL> ALTER TABLE tm_client ADD CONSTRAINT tm_client_pk PRIMARY KEY (cli_id);

Table modifiée.

SQL> ALTER TABLE tm_commande ADD CONSTRAINT tm_commande_pk PRIMARY KEY (com_id);

Table modifiée.

SQL> ALTER TABLE tm_compoasspecvalue ADD CONSTRAINT tm_comp_as_spec_value_pk PRIMARY KEY (cov_spv_id, cov_cmp_id);

Table modifiée.

SQL> ALTER TABLE tm_compoasstock ADD CONSTRAINT tm_composantasstock_pk PRIMARY KEY (cos_cmp_id, cos_emp_id);

Table modifiée.

SQL> ALTER TABLE tm_composant ADD CONSTRAINT tm_composant_pk PRIMARY KEY (cmp_id);

Table modifiée.

SQL> ALTER TABLE tm_composanttype ADD CONSTRAINT tm_composanttype_pk PRIMARY KEY (cot_id);

Table modifiée.

SQL> ALTER TABLE tm_compotypeasmarque ADD CONSTRAINT tm_compotype_as_marque_pk PRIMARY KEY (ctm_mar_id, ctm_cot_id);

Table modifiée.

SQL> ALTER TABLE tm_compotypeasspec ADD CONSTRAINT tm_compotype_as_spec_pk PRIMARY KEY (cts_cot_id, cts_spc_id);

Table modifiée.

SQL> ALTER TABLE tm_emplacement ADD CONSTRAINT tm_emplacement_pk PRIMARY KEY (emp_id);

Table modifiée.

SQL> ALTER TABLE tm_lignecommande ADD CONSTRAINT tm_ligne_commande_pk PRIMARY KEY (lco_cmp_id, lco_com_id);

Table modifiée.

SQL> ALTER TABLE tm_manager ADD CONSTRAINT tm_manager_pk PRIMARY KEY (man_id);

Table modifiée.

SQL> ALTER TABLE tm_marque ADD CONSTRAINT tm_marque_pk PRIMARY KEY (mar_id);

Table modifiée.

SQL> ALTER TABLE tm_specasvalue ADD CONSTRAINT tm_specificationasvalue_pk PRIMARY KEY (spv_id);

Table modifiée.

SQL> ALTER TABLE tm_specification ADD CONSTRAINT tm_specification_pk PRIMARY KEY (spc_id);

Table modifiée.

SQL> ALTER TABLE tm_changestockenatt ADD CONSTRAINT tm_changenatt_compostock_FK FOREIGN KEY (cha_cos_cmp_id, cha_cos_emp_id)
  2  	     REFERENCES tm_compoasstock (cos_cmp_id,cos_emp_id) ON DELETE CASCADE;

Table modifiée.

SQL> ALTER TABLE tm_commande ADD CONSTRAINT tm_commande_tm_client_FK FOREIGN KEY (com_cli_id)
  2  	     REFERENCES tm_client (cli_id) ON DELETE CASCADE;

Table modifiée.

SQL> ALTER TABLE tm_compoasspecvalue ADD CONSTRAINT tm_compasspecvalue_compo_FK FOREIGN KEY (cov_cmp_id)
  2  	     REFERENCES tm_composant (cmp_id) ON DELETE CASCADE;

Table modifiée.

SQL> ALTER TABLE tm_compoasspecvalue ADD CONSTRAINT tm_compspecvalue_specvalue_FK FOREIGN KEY (cov_spv_id)
  2  	     REFERENCES tm_specasvalue (spv_id)ON DELETE CASCADE;

Table modifiée.

SQL> ALTER TABLE tm_compoasstock ADD CONSTRAINT tm_compoasstock_compo_FK FOREIGN KEY (cos_cmp_id)
  2  	     REFERENCES tm_composant (cmp_id) ON DELETE CASCADE;

Table modifiée.

SQL> ALTER TABLE tm_compoasstock ADD CONSTRAINT tm_compstock_tm_emplac_FK FOREIGN KEY (cos_emp_id)
  2  	     REFERENCES tm_emplacement (emp_id) ON DELETE CASCADE;

Table modifiée.

SQL> ALTER TABLE tm_composant ADD CONSTRAINT tm_compo_tm_compotype_FK FOREIGN KEY (cmp_cot_id)
  2  	     REFERENCES tm_composanttype (cot_id) ON DELETE CASCADE;

Table modifiée.

SQL> ALTER TABLE tm_composant ADD CONSTRAINT tm_compo_tm_marque_FK FOREIGN KEY (cmp_mar_id)
  2  	     REFERENCES tm_marque (mar_id) ON DELETE CASCADE;

Table modifiée.

SQL> ALTER TABLE tm_compotypeasmarque ADD CONSTRAINT tm_compotypemark_compotype_FK FOREIGN KEY (ctm_cot_id)
  2  	     REFERENCES tm_composanttype (cot_id) ON DELETE CASCADE;

Table modifiée.

SQL> ALTER TABLE tm_compotypeasmarque ADD CONSTRAINT tm_compotypemark_tm_marque_FK FOREIGN KEY (ctm_mar_id)
  2  	     REFERENCES tm_marque (mar_id) ON DELETE CASCADE;

Table modifiée.

SQL> ALTER TABLE tm_compotypeasspec ADD CONSTRAINT tm_compotypespec_compotype_FK FOREIGN KEY (cts_cot_id)
  2  	     REFERENCES tm_composanttype (cot_id) ON DELETE CASCADE;

Table modifiée.

SQL> ALTER TABLE tm_compotypeasspec ADD CONSTRAINT tm_compotypespec_spec_FK FOREIGN KEY (cts_spc_id)
  2  	     REFERENCES tm_specification (spc_id) ON DELETE CASCADE;

Table modifiée.

SQL> ALTER TABLE tm_lignecommande ADD CONSTRAINT tm_ligne_commande_commande_FK FOREIGN KEY (lco_com_id)
  2  	     REFERENCES tm_commande (com_id) ON DELETE CASCADE;

Table modifiée.

SQL> ALTER TABLE tm_lignecommande ADD CONSTRAINT tm_ligne_commande_tm_compo_FK FOREIGN KEY (lco_cmp_id)
  2  	     REFERENCES tm_composant (cmp_id) ON DELETE CASCADE;

Table modifiée.

SQL> ALTER TABLE tm_specasvalue ADD CONSTRAINT tm_specasvalue_spec_FK FOREIGN KEY (spv_spc_id)
  2  	     REFERENCES tm_specification (spc_id) ON DELETE CASCADE;

Table modifiée.

SQL> 
SQL> 
SQL> SPOOL OFF
